"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
//#region @backend
var path = require("path");
var rimraf = require("rimraf");
var mocks_1 = require("./mocks");
var tnp_helpers_1 = require("tnp-helpers");
var dbPath = path.join(process.cwd(), 'tmp-db.json');
exports.config = {
    dbLocation: dbPath,
    pathes: {
        tmp_transaction_pid_txt: path.join(process.cwd(), 'tmp-transaciton-pid.txt')
    }
};
var wrapper_db_backend_1 = require("./wrapper-db.backend");
var index_1 = require("./index");
function default_1() {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        var db, param, keysparams, fromParam, index, key, isMatch, projects;
        return tslib_1.__generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    mocks_1.mocks();
                    rimraf.sync(dbPath);
                    return [4 /*yield*/, wrapper_db_backend_1.TnpDB.Instance(dbPath)];
                case 1:
                    db = _a.sent();
                    param = process.argv[2];
                    keysparams = Object.keys(index_1.DB);
                    fromParam = false;
                    for (index = 0; index < keysparams.length; index++) {
                        key = keysparams[index];
                        isMatch = tnp_helpers_1.Helpers.cliTool.match(key, process.argv.slice(2));
                        if (isMatch) {
                            // console.log('adsasda!!', key)
                            fromParam = true;
                            index_1.DB[key]();
                            process.stdin.resume();
                            break;
                        }
                    }
                    if (!!fromParam) return [3 /*break*/, 3];
                    return [4 /*yield*/, db.getProjects()];
                case 2:
                    projects = _a.sent();
                    _a.label = 3;
                case 3: return [2 /*return*/];
            }
        });
    });
}
exports.default = default_1;
//#endregion
//# sourceMappingURL=app.js.map