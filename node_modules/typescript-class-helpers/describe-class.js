"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tnp_core_1 = require("tnp-core");
var symbols_1 = require("./symbols");
/**
  * @DEPRECATED
  * Describe fields assigned in class
  */
var FRegEx = new RegExp(/(?:this\.)(.+?(?= ))/g);
function describeFromClassStringify(target, parent) {
    if (parent === void 0) { parent = false; }
    var result = [];
    if (parent) {
        var proto = Object.getPrototypeOf(target.prototype);
        if (proto) {
            result = result.concat(describeFromClassStringify(proto.constructor, parent));
        }
    }
    result = result.concat(target.toString().match(FRegEx) || []);
    return result.map(function (prop) { return prop.replace('this.', ''); });
}
exports.describeFromClassStringify = describeFromClassStringify;
/**
   * Describe fields assigne through @DefaultModelWithMapping decorator
   * without functions
   */
function describeByDefaultModelsAndMapping(target) {
    var res = {};
    if (target) {
        if (target[symbols_1.SYMBOL.DEFAULT_MODEL]) {
            Object.keys(target[symbols_1.SYMBOL.DEFAULT_MODEL])
                .filter(function (key) { return !tnp_core_1._.isFunction(target[symbols_1.SYMBOL.DEFAULT_MODEL][key]); })
                .forEach(function (key) { return res[key] = null; });
        }
        var mapping = target[symbols_1.SYMBOL.MODELS_MAPPING];
        if (tnp_core_1._.isArray(mapping)) {
            mapping.forEach(function (m) {
                Object.keys(m)
                    .forEach(function (key) {
                    res[key] = null;
                });
            });
        }
        else if (mapping) {
            Object.keys(mapping)
                .forEach(function (key) {
                res[key] = null;
            });
        }
    }
    var propNames = Object.keys(res).filter(function (f) { return !!f; });
    propNames = (!propNames.includes('id') ? ['id'] : []).concat(propNames);
    return propNames;
}
exports.describeByDefaultModelsAndMapping = describeByDefaultModelsAndMapping;
//# sourceMappingURL=describe-class.js.map