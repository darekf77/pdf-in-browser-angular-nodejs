"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
//#region @backend
var tnp_helpers_1 = require("tnp-helpers");
var vpn_split_backend_1 = require("./vpn-split.backend");
var TO_DELETE = {};
function run(args) {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        var ins, opt;
        return tslib_1.__generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    tnp_helpers_1.Helpers.clearConsole();
                    return [4 /*yield*/, vpn_split_backend_1.VpnSplit.Instance({ additionalDefaultHosts: TO_DELETE })];
                case 1:
                    ins = _a.sent();
                    opt = tnp_helpers_1.Helpers.cliTool.argsFrom(args);
                    args = tnp_helpers_1.Helpers.cliTool.cleanCommand(args, opt).split(' ');
                    if (!opt.testModeServerClient) return [3 /*break*/, 2];
                    return [3 /*break*/, 6];
                case 2:
                    if (!(args.join().trim() === '')) return [3 /*break*/, 4];
                    return [4 /*yield*/, ins.server()];
                case 3:
                    _a.sent();
                    return [3 /*break*/, 6];
                case 4: return [4 /*yield*/, ins.client(tnp_helpers_1.Helpers.urlParse(args.shift()))];
                case 5:
                    _a.sent();
                    _a.label = 6;
                case 6:
                    process.stdin.resume();
                    return [2 /*return*/];
            }
        });
    });
}
exports.run = run;
//#endregion
//# sourceMappingURL=start.backend.js.map