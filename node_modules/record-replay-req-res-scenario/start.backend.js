"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var record_replay_req_res_scenario_backend_1 = require("./record-replay-req-res-scenario.backend");
var tnp_helpers_1 = require("tnp-helpers");
function run(args) {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        var ins, command, _a, scenarios, params, index, s;
        return tslib_1.__generator(this, function (_b) {
            switch (_b.label) {
                case 0:
                    ins = record_replay_req_res_scenario_backend_1.RecordReplayReqResScenario.Instance();
                    command = args.shift();
                    if (!(command === 'record')) return [3 /*break*/, 2];
                    tnp_helpers_1.Helpers.clearConsole();
                    return [4 /*yield*/, ins.record(args)];
                case 1:
                    _b.sent();
                    _b.label = 2;
                case 2:
                    if (!(command === 'replay')) return [3 /*break*/, 8];
                    return [4 /*yield*/, ins.resolveScenariosData(args, true)];
                case 3:
                    _a = _b.sent(), scenarios = _a.scenarios, params = _a.params;
                    index = 0;
                    _b.label = 4;
                case 4:
                    if (!(index < scenarios.length)) return [3 /*break*/, 7];
                    s = scenarios[index];
                    return [4 /*yield*/, s.start(params, true)];
                case 5:
                    _b.sent();
                    _b.label = 6;
                case 6:
                    index++;
                    return [3 /*break*/, 4];
                case 7:
                    process.stdin.resume();
                    _b.label = 8;
                case 8: return [2 /*return*/];
            }
        });
    });
}
exports.run = run;
//# sourceMappingURL=start.backend.js.map