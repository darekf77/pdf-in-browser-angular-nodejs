"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var tnp_core_1 = require("tnp-core");
var morphi_1 = require("morphi");
var BootstrapWorker = /** @class */ (function () {
    function BootstrapWorker() {
    }
    BootstrapWorker.bootstrap = function (classFN, entities) {
        var _this = this;
        if (entities === void 0) { entities = []; }
        return function (port) { return tslib_1.__awaiter(_this, void 0, void 0, function () {
            var host, controllers, context, singleton;
            return tslib_1.__generator(this, function (_a) {
                switch (_a.label) {
                    case 0:
                        host = "http://localhost:" + port;
                        controllers = [classFN];
                        return [4 /*yield*/, morphi_1.Morphi.init({
                                host: host,
                                controllers: controllers,
                                entities: entities,
                                mode: 'backend/frontend-worker'
                            })];
                    case 1:
                        context = _a.sent();
                        singleton = tnp_core_1._.first(context.controllers);
                        console.log("hello from '" + singleton.filename);
                        console.log(BootstrapWorker.READY_MESSAGE + (" on pid: " + process.pid));
                        return [2 /*return*/, context];
                }
            });
        }); };
    };
    BootstrapWorker.READY_MESSAGE = 'I am ready process worker';
    return BootstrapWorker;
}());
exports.BootstrapWorker = BootstrapWorker;
//# sourceMappingURL=bootsrap-worker.backend.js.map